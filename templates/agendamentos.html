<!DOCTYPE html>
<html>
<head>
    <title>Agendamentos</title>
</head>
<body>
    <h1>Agendamentos</h1>

    <a href="{{ url_for('index') }}">Voltar</a>
    <br><br>

    <a href="{{ url_for('novo_agendamento') }}">
        <button>Novo Agendamento</button>
    </a>

    {% if whatsapp_modo_simulado %}
        <p style="color: #b00020;"><strong>Aviso:</strong> WhatsApp est√° em modo simulado. Defina <code>WHATSAPP_SIMULADO=0</code> no servidor para envio real.</p>
    {% endif %}

    {% if enviados is not none and falhas is not none %}
        <p><strong>Resultado:</strong> enviados {{ enviados }} | falhas {{ falhas }}</p>
    {% endif %}

    <hr>

    {% if agendamentos %}
        {% for a in agendamentos %}
            <p>
                Cliente: {{ a.cliente_nome }} ({{ a.cliente_telefone }})<br>
                Servi√ßo: {{ servicos.get(a.servico_id, 'N√£o encontrado') }}<br>
                Profissional: {{ profissionais.get(a.profissional_id, 'N√£o encontrado') }}<br>
                Data: {{ a.data.strftime('%d/%m/%Y') }}<br>
                Hor√°rio: {{ a.hora_inicio.strftime('%H:%M') }} √†s {{ a.hora_fim.strftime('%H:%M') }}<br>
                Status: {{ a.status }}<br>
                Lembrete WhatsApp: 
                {% if a.lembrete_whatsapp_ativo %}
                    Ativo
                {% else %}
                    Inativo
                {% endif %}
                {% if a.lembrete_whatsapp_enviado_em %}
                    | Enviado em {{ a.lembrete_whatsapp_enviado_em.strftime('%d/%m/%Y %H:%M') }}
                {% endif %}
                <br><br>

                <form method="POST" action="{{ url_for('enviar_lembrete_whatsapp_agendamento', agendamento_id=a.id) }}" style="display:inline;">
                    <button type="submit" title="Enviar WhatsApp" aria-label="Enviar WhatsApp">üí¨</button>
                </form>
            </p>
            <hr>
        {% endfor %}
    {% else %}
        <p>Nenhum agendamento cadastrado.</p>
    {% endif %}
</body>
</html>